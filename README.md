# EPFL CS-433 - Project II: Recommender System

## Contents
- README.MD (this)
- submit
  - submission.csv (with RMSE of 1.025)
- data
  - data_train.csv (original data from https://www.crowdai.org/challenges/epfl-ml-recommender-system/dataset_files)
  - sample_submission.csv (original data from https://www.crowdai.org/challenges/epfl-ml-recommender-system/dataset_files)
  - item_feats_SGD.npy (latent features of items after training using SGD, generated by run.py)
  - user_feats_SGD.npy (latent features of users after training using SGD, generated by run.py)
- src
  - data_process.py (module for data preprocess and results submission)
  - SGD_helpers.py (module for SGD, mostly matching the lab)
  - MF_helpers.py (module for the bias matrix factorization and user-item ratings matrix)

  - run.py (main script for submiting the final results)
  
  - gs_reg_MF.py (script for grid search of the regularized matrix factorization)
  - gs_biased_MF.py (script for grid search of the regularized matrix factorization)
  - implement_surprise.py (script for cross validation using library surprise)

## Codes
### Prerequisites
- Python 3.6+
- Numpy
- Scipy
- Pandas

> #### Note for running implement_surprise.py, some other libraries are required. Please refer to the script for details.

### Introduction
				
1. Report : this is where you will discover how we tackled the competition.

2. Notebooks : 

	- xxx.ipynb: Notebook using the User - user collaborative filtering technique. Here are the following steps of the notebook:
		
		1. Load the data, divide the ratings matrix in training and testing set.
		2. Statistics on the dataset
		3. Presentation of the algorithm used: similarity metrics, how to compute the predictions
		4. Find best parameters (similarity matrix and number K of best neighbors to keep for each user) by running the algorithm numerous times with different parameters: train on training ratings and test on testing ratings with RMSE.
		5. Compute the wanted predictions on the whole ratings (no test), using the algorithm with the best found parameters.
		6. Creation of csv file for the submission.

3. Python modules :

    - pre_post_process.py : This module allows us to transform the data of a csv file into a sparse ratings matrix and functions to convert the final made predictions in a csv file of the correct format expected by the Kaggle competition. It contains the following important functions:
							
			- preprocess_data(data):
				Parameters:
				Returns:
				
				
    - run.py : This module executes the program

### Submission
To run run.py:
- On Mac/Windows : 
open the Terminal, enter the zipped folder, enter to the folder *./src/*; 
To execute enter : python run.py;
submission.py is in *./submit/*;
item_feats_SGD.npy and user_feats_SGD.npy are in *./submit/*.
